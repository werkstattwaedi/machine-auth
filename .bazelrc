# Import particle-bazel configuration
import %workspace%/third_party/particle/.bazelrc

# Project-specific settings
# Note: hedron_compile_commands requires convenience symlinks (bazel-out, etc.)
# so we don't disable them here
common --experimental_platform_in_output_dir=True

# Host toolchain configuration
# Enable layering check support (also configures module maps for includes)
common --@pigweed//pw_toolchain/host_clang:layering_check

# LVGL configuration (host default - P2 overrides via platform flags)
build --@lvgl//:lv_conf=//maco_firmware/targets/host:lvgl_conf

# Log backend: pw_log_basic is the default for host builds and tests.
# P2 firmware uses p2_system platform which enables tokenized logging via RPC.

# Sanitizer configs
common:asan --@pigweed//pw_toolchain/host_clang:asan
common:tsan --@pigweed//pw_toolchain/host_clang:tsan
common:ubsan --@pigweed//pw_toolchain/host_clang:ubsan

# Suppress DEBUG log messages (filters "Dispatcher running task" spam)
build --copt=-DPW_LOG_LEVEL=PW_LOG_LEVEL_INFO

# Increase pw_system dispatcher thread stack for P2 coroutines.
# Default is 2048 which is too small for coroutines that do
# ASCON encryption + HDLC encoding + TCP socket operations.
build --copt=-DPW_SYSTEM_ASYNC_DISPATCHER_THREAD_STACK_SIZE_BYTES=16384

